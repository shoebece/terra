trigger: none

pool:
  name: aks-infra

name: $(Date:yyyyMMdd).$(Rev:r) (cdmz_deployment)

variables:
  - group: environment
  - group: backend

stages:

- template: templates/stage/stages-plan.yml
  parameters:
    st_serviceconn: CDP_Management
    st_env: prod
    st_dependson: deploy_prod_networking
    st_workingdir: '$(System.DefaultWorkingDirectory)/projects/cdmz/fivetran-integration/'
    st_backend_key: 'prod/cdmz/fivetran-integration.tfstate'
    st_sub_project: fivetran_integration
    st_additional_vars: "-var vm_admin_password=$(environment.FIVETRAN_VM_PASSWORD) -var sql_admin_password=$(environment.FIVETRAN_SQL_PASSWORD) "